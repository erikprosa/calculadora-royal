<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Calculadora Royal</title>

<link rel="icon" href="https://raw.githubusercontent.com/erikprosa/calculadora-royal/2d83a7735140ea56946b9eb71d47e5c151829820/favicon.svg" type="image/svg+xml">
<link rel="shortcut icon" href="https://raw.githubusercontent.com/erikprosa/calculadora-royal/2d83a7735140ea56946b9eb71d47e5c151829820/favicon.svg" type="image/svg+xml">
<link rel="preload" href="https://raw.githubusercontent.com/erikprosa/calculadora-royal/2d83a7735140ea56946b9eb71d47e5c151829820/favicon.svg" as="image">

<meta name="theme-color" content="#ffffff" id="meta-theme-color" />
<style>
  /* =========================================================
     1. IMAGENS E ÍCONES
     ========================================================= */
  :root {
    --src-logo-light: url("https://raw.githubusercontent.com/erikprosa/calculadora-royal/2d83a7735140ea56946b9eb71d47e5c151829820/Logo.svg");
    --src-logo-dark:  url("https://raw.githubusercontent.com/erikprosa/calculadora-royal/2d83a7735140ea56946b9eb71d47e5c151829820/Logo_White.svg");
    --src-icon-sun: "https://raw.githubusercontent.com/erikprosa/calculadora-royal/c5582556e5e0dee0f2164f75f2dc54668195e1df/sol_full.svg";
    --src-icon-moon: "https://raw.githubusercontent.com/erikprosa/calculadora-royal/c5582556e5e0dee0f2164f75f2dc54668195e1df/lua_full.svg";
  }

  /* =========================================================
     2. CONFIGURAÇÕES GERAIS E GLOBAIS
     ========================================================= */
  :root {
    /* Fontes Base */
    --font-family-base: Inter, "Segoe UI", Roboto, Arial, sans-serif;
    
    /* Configuração Geral de Inputs (Defaults) */
    --global-input-size: 16px;   
    --global-input-weight: 800;

    /* Tamanhos de Texto Gerais */
    --fs-h1: 18px;              /* Título Principal */
    --fs-section-title: 16px;   /* Títulos das Seções */
    --fs-label: 13px;           /* Labels dos campos */
    --fs-label-small: 11px;     /* Texto pequeno ao lado do label */
    --fs-note: 12px;            /* Notas de rodapé */
    --fs-credit: 13px;          /* Assinatura do dev */

    /* Layout Global */
    --radius-card: 14px;
    --radius-box: 8px;
    --box-height: 56px;
    --field-width: 60%;
    --gap-rows: 6px;

    /* Cores Globais Base (Tema Light) */
    --bg-page: #ffffff;
    --bg-card: #ffffff;
    --text-main: #12223a;       
    --text-label: #6b7280;      
    --text-muted: #6b7280;      
    --border-global: #111;      
    --accent-color: #23395B;
    --line-color: rgba(35, 57, 91, 0.25);
    
    /* Switch de Tema (Light) */
    --switch-track: #E6E6EA;
    --switch-knob: #FFFFFF;
    --switch-active-track: #D1D5DB;
    --switch-border: rgba(0,0,0,0.12);
    --icon-active: #000000;
    --icon-inactive: #8a8a8a;
    
    /* Linhas */
    --line-thickness: 1px;
    --line-margin-x: 14px;
  }

  /* Sobrescrita Global (Tema Dark) */
  .theme-dark {
    --bg-page: #212830;
    --bg-card: #0f1720;
    --text-main: #ffffff;
    --text-label: #A3A8B3;
    --text-muted: #A3A8B3;
    --border-global: #dbdbdb;
    --accent-color: #23395B;
    --line-color: rgba(255, 255, 255, 0.25);

    /* Switch */
    --switch-track: #2b3035;
    --switch-knob: #d3d3d3;
    --switch-active-track: #3a3f45;
    --switch-border: rgba(255,255,255,0.08);
  }

  /* =========================================================
     3. GRUPOS DE COMPONENTES (ORGANIZAÇÃO POR ITEM)
     ========================================================= */

  /* --- [GRUPO] DOCUMENTAÇÃO --- */
  :root {
    --fs-doc: 13px;
    --fw-doc: 500;
    --text-doc: #6b7280;
  }
  .theme-dark {
    --text-doc: #A3A8B3;
  }

  /* --- [GRUPO] VALOR DE NEGOCIAÇÃO --- */
  :root {
    --box-neg-bg: #F8DCDC;
    --box-neg-text: #23395B;
    --box-neg-border: #111;
    /* Tipografia Específica */
    --box-neg-fs: 16px;      /* Tamanho */
    --box-neg-fw: 800;       /* Negrito */
    --box-neg-style: normal; /* Itálico (normal/italic) */
    --box-neg-deco: none;    /* Sublinhado (none/underline) */
  }
  .theme-dark {
    --box-neg-bg: #F8DCDC;
    --box-neg-text: #23395B;
    --box-neg-border: #dbdbdb;
  }

  /* --- [GRUPO] DESCONTO (Select) --- */
  :root {
    --box-desc-bg: #F8DCDC;
    --box-desc-text: #23395B;
    --box-desc-border: #111;
    /* Tipografia Específica */
    --box-desc-fs: 16px;
    --box-desc-fw: 800;
    --box-desc-style: normal;
    --box-desc-deco: none;
  }
  .theme-dark {
    --box-desc-bg: #F8DCDC;
    --box-desc-text: #23395B;
    --box-desc-border: #dbdbdb;
  }

  /* --- [GRUPO] DESCONTO (Outros - Input) --- */
  :root {
    --box-desc-out-bg: #F8DCDC;
    --box-desc-out-text: #23395B;
    --box-desc-out-border: #111;
    /* Tipografia Específica */
    --box-desc-out-fs: 16px;
    --box-desc-out-fw: 800;
    --box-desc-out-style: normal;
    --box-desc-out-deco: none;
  }
  .theme-dark {
    --box-desc-out-bg: #F8DCDC;
    --box-desc-out-text: #23395B;
    --box-desc-out-border: #dbdbdb;
  }

  /* --- [GRUPO] VALOR DE VENDA (Leitura) --- */
  :root {
    --box-venda-bg: #D1FAE5;
    --box-venda-text: #23395B;
    --box-venda-border: #111;
    /* Tipografia Específica */
    --box-venda-fs: 16px;
    --box-venda-fw: 800;
    --box-venda-style: normal;
    --box-venda-deco: none;
  }
  .theme-dark {
    --box-venda-bg: #D1FAE5;
    --box-venda-text: #23395B;
    --box-venda-border: #dbdbdb;
  }

  /* --- [GRUPO] ENTRADA (Select) --- */
  :root {
    --box-ent-bg: #F8DCDC;
    --box-ent-text: #23395B;
    --box-ent-border: #111;
    /* Tipografia Específica */
    --box-ent-fs: 16px;
    --box-ent-fw: 800;
    --box-ent-style: normal;
    --box-ent-deco: none;
  }
  .theme-dark {
    --box-ent-bg: #F8DCDC;
    --box-ent-text: #23395B;
    --box-ent-border: #dbdbdb;
  }

  /* --- [GRUPO] ENTRADA (Outros - Input) --- */
  :root {
    --box-ent-out-bg: #F8DCDC;
    --box-ent-out-text: #23395B;
    --box-ent-out-border: #111;
    /* Tipografia Específica */
    --box-ent-out-fs: 16px;
    --box-ent-out-fw: 800;
    --box-ent-out-style: normal;
    --box-ent-out-deco: none;
  }
  .theme-dark {
    --box-ent-out-bg: #F8DCDC;
    --box-ent-out-text: #23395B;
    --box-ent-out-border: #dbdbdb;
  }

  /* --- [GRUPO] NÚMERO DE PARCELAS --- */
  :root {
    --box-parc-bg: #F8DCDC;
    --box-parc-text: #23395B;
    --box-parc-border: #111;
    /* Tipografia Específica */
    --box-parc-fs: 16px;
    --box-parc-fw: 800;
    --box-parc-style: normal;
    --box-parc-deco: none;
  }
  .theme-dark {
    --box-parc-bg: #F8DCDC;
    --box-parc-text: #23395B;
    --box-parc-border: #dbdbdb;
  }

  /* --- [GRUPO] RESULTADO: VALOR DA ENTRADA --- */
  :root {
    --box-res-ent-bg: #FFFF66;
    --box-res-ent-text: #23395B;
    --box-res-ent-border: #111;
    /* Tipografia Específica */
    --box-res-ent-fs: 16px;
    --box-res-ent-fw: 800;
    --box-res-ent-style: normal;
    --box-res-ent-deco: none;
  }
  .theme-dark {
    --box-res-ent-bg: #FFFF66;
    --box-res-ent-text: #23395B;
    --box-res-ent-border: #dbdbdb;
  }

  /* --- [GRUPO] RESULTADO: VALOR DA PARCELA MENSAL --- */
  :root {
    --box-res-parc-bg: #FFFF66;
    --box-res-parc-text: #23395B;
    --box-res-parc-border: #111;
    /* Tipografia Específica */
    --box-res-parc-fs: 16px;
    --box-res-parc-fw: 800;
    --box-res-parc-style: normal;
    --box-res-parc-deco: none;
  }
  .theme-dark {
    --box-res-parc-bg: #FFFF66;
    --box-res-parc-text: #23395B;
    --box-res-parc-border: #dbdbdb;
  }

  /* --- [GRUPO] CARTÃO DE CRÉDITO (Select) --- */
  :root {
    --box-card-bg: #F8DCDC;
    --box-card-text: #23395B;
    --box-card-border: #111;
    /* Tipografia Específica */
    --box-card-fs: 16px;
    --box-card-fw: 800;
    --box-card-style: normal;
    --box-card-deco: none;
  }
  .theme-dark {
    --box-card-bg: #F8DCDC;
    --box-card-text: #23395B;
    --box-card-border: #dbdbdb;
  }

  /* --- [GRUPO] RESULTADO: PARCELA NO CARTÃO --- */
  :root {
    --box-res-card-bg: #FFFF66;
    --box-res-card-text: #23395B;
    --box-res-card-border: #111;
    /* Tipografia Específica */
    --box-res-card-fs: 16px;
    --box-res-card-fw: 800;
    --box-res-card-style: normal;
    --box-res-card-deco: none;
  }
  .theme-dark {
    --box-res-card-bg: #FFFF66;
    --box-res-card-text: #23395B;
    --box-res-card-border: #dbdbdb;
  }

  /* --- [GRUPO] SALDO A PAGAR (Sem juros) --- */
  :root {
    --box-saldo-bg: #f6f6f6;
    --box-saldo-text: #23395B;
    --box-saldo-border: #111;
    /* Tipografia Específica */
    --box-saldo-fs: 16px;
    --box-saldo-fw: 800;
    --box-saldo-style: normal;
    --box-saldo-deco: none;
  }
  .theme-dark {
    --box-saldo-bg: #f6f6f6;
    --box-saldo-text: #23395B;
    --box-saldo-border: #dbdbdb;
  }

  /* --- [GRUPO] VALOR PARCELADO --- */
  :root {
    --box-parc-fin-bg: #f6f6f6;
    --box-parc-fin-text: #23395B;
    --box-parc-fin-border: #111;
    /* Tipografia Específica */
    --box-parc-fin-fs: 16px;
    --box-parc-fin-fw: 800;
    --box-parc-fin-style: normal;
    --box-parc-fin-deco: none;
  }
  .theme-dark {
    --box-parc-fin-bg: #f6f6f6;
    --box-parc-fin-text: #23395B;
    --box-parc-fin-border: #dbdbdb;
  }

  /* --- [GRUPO] PRIMEIRA PARCELA (Data) --- */
  :root {
    --box-data-bg: #f6f6f6;
    --box-data-text: #23395B;
    --box-data-border: #111;
    /* Tipografia Específica */
    --box-data-fs: 16px;
    --box-data-fw: 800;
    --box-data-style: normal;
    --box-data-deco: none;
  }
  .theme-dark {
    --box-data-bg: #f6f6f6;
    --box-data-text: #23395B;
    --box-data-border: #dbdbdb;
  }

  /* --- [GRUPO] VALOR TOTAL DA VENDA --- */
  :root {
    --box-total-venda-bg: #f6f6f6;
    --box-total-venda-text: #23395B;
    --box-total-venda-border: #111;
    /* Tipografia Específica */
    --box-total-venda-fs: 16px;
    --box-total-venda-fw: 800;
    --box-total-venda-style: normal;
    --box-total-venda-deco: none;
  }
  .theme-dark {
    --box-total-venda-bg: #f6f6f6;
    --box-total-venda-text: #23395B;
    --box-total-venda-border: #dbdbdb;
  }

  /* --- [GRUPO] TOTAL DE JUROS --- */
  :root {
    --box-juros-bg: #f6f6f6;
    --box-juros-text: #23395B;
    --box-juros-border: #111;
    /* Tipografia Específica */
    --box-juros-fs: 16px;
    --box-juros-fw: 800;
    --box-juros-style: normal;
    --box-juros-deco: none;
  }
  .theme-dark {
    --box-juros-bg: #f6f6f6;
    --box-juros-text: #23395B;
    --box-juros-border: #dbdbdb;
  }

  /* --- [GRUPO] PRESENTES --- */
  :root {
    --box-gift-bg: #f6f6f6;
    --box-gift-text: #23395B;
    --box-gift-border: #111;
    /* Tipografia Específica */
    --box-gift-fs: 16px;
    --box-gift-fw: 800;
    --box-gift-style: normal;
    --box-gift-deco: none;
  }
  .theme-dark {
    --box-gift-bg: #f6f6f6;
    --box-gift-text: #23395B;
    --box-gift-border: #dbdbdb;
  }


  /* -----------------------
     ESTILOS GERAIS (CSS)
     ----------------------- */
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;}
  body{
    font-family: var(--font-family-base);
    background: var(--bg-page);
    color: var(--accent-color);
    display:flex;
    align-items:flex-start;
    justify-content:center;
    padding:18px 12px;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    transition: background .22s ease, color .22s ease;
  }

  .wrap{ width:100%; max-width:520px; }
  .card{
    background: var(--bg-card);
    border-radius: var(--radius-card);
    padding:16px 14px 22px 14px;
    box-shadow: 0 8px 22px rgba(20,30,60,0.06);
    color: var(--accent-color);
    transition: background .22s ease, color .22s ease, box-shadow .22s ease;
    position: relative;
    overflow: visible;
  }

  /* Top Image & Logo */
  .topImageWrap { display:flex; justify-content:center; margin-bottom:12px; }
  .topImageLink{
    width: 125px; height: 125px;
    border-radius:50%;
    overflow:hidden;
    display:flex; align-items:center; justify-content:center;
  }
  .topImage {
    width:100%; height:100%; display:block; object-fit:contain; max-width:100%;
  }

  /* Tipografia */
  h1{ font-size:var(--fs-h1); margin:0 0 10px; color:var(--text-main); text-align:center; font-weight:700; }
  .section-title{ text-align:center; margin-top:6px; font-weight:800; color:var(--text-main); font-size:var(--fs-section-title); }

  /* Section Divider (LINHAS) */
  section{
    margin-top:10px;
    padding-top: calc(8px + 1px);
    position: relative;
  }
  section::before{
    content: ""; position: absolute;
    left: var(--line-margin-x); right: var(--line-margin-x); top: 0;
    height: var(--line-thickness);
    background: var(--line-color);
    border-radius: 0.5px; pointer-events: none;
  }

  .row{ display:flex; flex-direction:column; align-items:center; gap:var(--gap-rows); padding:8px 0; }

  /* Animação dos campos extras */
  .row-animate {
    max-height: 0; opacity: 0; overflow: hidden;
    transition: max-height 0.4s ease, opacity 0.4s ease, padding 0.4s ease;
    padding-top: 0 !important; padding-bottom: 0 !important;
  }
  .row-animate.show {
    max-height: 120px; opacity: 1;
    padding-top: 8px !important; padding-bottom: 8px !important;
  }

  /* Labels */
  label{
    width:var(--field-width);
    text-align:left;
    font-size:var(--fs-label);
    color:var(--text-label);
    font-weight:700;
    display:flex; align-items:baseline; gap:2px;
  }
  label small{ font-size:var(--fs-label-small); color:var(--text-label); font-weight:400; margin-left:6px; }
  
  /* Padronização do texto dinâmico */
  label small.dynamic{ font-size:var(--fs-label-small); color:var(--text-label); font-weight:400; opacity:1; margin-left:6px; }

  /* --- ESTILO CSS DA DOCUMENTAÇÃO --- */
  .doc-label {
    width: var(--field-width);
    font-size: var(--fs-doc);
    color: var(--text-doc);
    font-weight: var(--fw-doc);
    justify-content: left;
  }

  /* ----------------------------------------------------
     INPUT BOX - CONFIGURAÇÃO GERAL E MAPEAMENTO
     ---------------------------------------------------- */
  .inputBox{
    width:var(--field-width);
    height:var(--box-height);
    display:flex; align-items:center; justify-content:center;
    padding:0 14px;
    border-radius:var(--radius-box);
    border:2px solid var(--border-global);
    font-weight:700;
    transition: background .18s ease, border-color .18s ease;
  }

  /* Mapeamento de Cores e Tipografia por ID */
  
  .inputBox:has(#valorNeg) { background: var(--box-neg-bg); border-color: var(--box-neg-border); }
  .inputBox:has(#valorNeg) input { 
    color: var(--box-neg-text); 
    -webkit-text-fill-color: var(--box-neg-text);
    font-size: var(--box-neg-fs);
    font-weight: var(--box-neg-fw);
    font-style: var(--box-neg-style);
    text-decoration: var(--box-neg-deco);
  }

  .inputBox:has(#desconto) { background: var(--box-desc-bg); border-color: var(--box-desc-border); }
  .inputBox:has(#desconto) select { 
    color: var(--box-desc-text);
    font-size: var(--box-desc-fs);
    font-weight: var(--box-desc-fw);
    font-style: var(--box-desc-style);
    text-decoration: var(--box-desc-deco);
  }
  
  .inputBox:has(#descontoOutros) { background: var(--box-desc-out-bg); border-color: var(--box-desc-out-border); }
  .inputBox:has(#descontoOutros) input { 
    color: var(--box-desc-out-text); 
    -webkit-text-fill-color: var(--box-desc-out-text); 
    font-size: var(--box-desc-out-fs);
    font-weight: var(--box-desc-out-fw);
    font-style: var(--box-desc-out-style);
    text-decoration: var(--box-desc-out-deco);
  }

  .inputBox:has(#valorVendaText) { background: var(--box-venda-bg); border-color: var(--box-venda-border); }
  .inputBox:has(#valorVendaText) .balance { 
    color: var(--box-venda-text); 
    font-size: var(--box-venda-fs);
    font-weight: var(--box-venda-fw);
    font-style: var(--box-venda-style);
    text-decoration: var(--box-venda-deco);
  }

  .inputBox:has(#entrada) { background: var(--box-ent-bg); border-color: var(--box-ent-border); }
  .inputBox:has(#entrada) select { 
    color: var(--box-ent-text); 
    font-size: var(--box-ent-fs);
    font-weight: var(--box-ent-fw);
    font-style: var(--box-ent-style);
    text-decoration: var(--box-ent-deco);
  }

  .inputBox:has(#entradaOutros) { background: var(--box-ent-out-bg); border-color: var(--box-ent-out-border); }
  .inputBox:has(#entradaOutros) input { 
    color: var(--box-ent-out-text); 
    -webkit-text-fill-color: var(--box-ent-out-text); 
    font-size: var(--box-ent-out-fs);
    font-weight: var(--box-ent-out-fw);
    font-style: var(--box-ent-out-style);
    text-decoration: var(--box-ent-out-deco);
  }

  .inputBox:has(#numParcelas) { background: var(--box-parc-bg); border-color: var(--box-parc-border); }
  .inputBox:has(#numParcelas) select { 
    color: var(--box-parc-text); 
    font-size: var(--box-parc-fs);
    font-weight: var(--box-parc-fw);
    font-style: var(--box-parc-style);
    text-decoration: var(--box-parc-deco);
  }

  .inputBox:has(#valorEntradaText) { background: var(--box-res-ent-bg); border-color: var(--box-res-ent-border); }
  .inputBox:has(#valorEntradaText) .balance { 
    color: var(--box-res-ent-text); 
    font-size: var(--box-res-ent-fs);
    font-weight: var(--box-res-ent-fw);
    font-style: var(--box-res-ent-style);
    text-decoration: var(--box-res-ent-deco);
  }

  .inputBox:has(#valorParcelaText) { background: var(--box-res-parc-bg); border-color: var(--box-res-parc-border); }
  .inputBox:has(#valorParcelaText) .balance { 
    color: var(--box-res-parc-text); 
    font-size: var(--box-res-parc-fs);
    font-weight: var(--box-res-parc-fw);
    font-style: var(--box-res-parc-style);
    text-decoration: var(--box-res-parc-deco);
  }

  .inputBox:has(#cartao) { background: var(--box-card-bg); border-color: var(--box-card-border); }
  .inputBox:has(#cartao) select { 
    color: var(--box-card-text); 
    font-size: var(--box-card-fs);
    font-weight: var(--box-card-fw);
    font-style: var(--box-card-style);
    text-decoration: var(--box-card-deco);
  }

  .inputBox:has(#cartaoParcelaText) { background: var(--box-res-card-bg); border-color: var(--box-res-card-border); }
  .inputBox:has(#cartaoParcelaText) .balance { 
    color: var(--box-res-card-text); 
    font-size: var(--box-res-card-fs);
    font-weight: var(--box-res-card-fw);
    font-style: var(--box-res-card-style);
    text-decoration: var(--box-res-card-deco);
  }

  .inputBox:has(#saldoSemJurosText) { background: var(--box-saldo-bg); border-color: var(--box-saldo-border); }
  .inputBox:has(#saldoSemJurosText) .balance { 
    color: var(--box-saldo-text); 
    font-size: var(--box-saldo-fs);
    font-weight: var(--box-saldo-fw);
    font-style: var(--box-saldo-style);
    text-decoration: var(--box-saldo-deco);
  }

  .inputBox:has(#valorParceladoText) { background: var(--box-parc-fin-bg); border-color: var(--box-parc-fin-border); }
  .inputBox:has(#valorParceladoText) .balance { 
    color: var(--box-parc-fin-text); 
    font-size: var(--box-parc-fin-fs);
    font-weight: var(--box-parc-fin-fw);
    font-style: var(--box-parc-fin-style);
    text-decoration: var(--box-parc-fin-deco);
  }

  .inputBox:has(#primeiraParcelaText) { background: var(--box-data-bg); border-color: var(--box-data-border); }
  .inputBox:has(#primeiraParcelaText) .balance { 
    color: var(--box-data-text); 
    font-size: var(--box-data-fs);
    font-weight: var(--box-data-fw);
    font-style: var(--box-data-style);
    text-decoration: var(--box-data-deco);
  }

  .inputBox:has(#valorTotalVendaText) { background: var(--box-total-venda-bg); border-color: var(--box-total-venda-border); }
  .inputBox:has(#valorTotalVendaText) .balance { 
    color: var(--box-total-venda-text); 
    font-size: var(--box-total-venda-fs);
    font-weight: var(--box-total-venda-fw);
    font-style: var(--box-total-venda-style);
    text-decoration: var(--box-total-venda-deco);
  }

  .inputBox:has(#totalJurosText) { background: var(--box-juros-bg); border-color: var(--box-juros-border); }
  .inputBox:has(#totalJurosText) .balance { 
    color: var(--box-juros-text); 
    font-size: var(--box-juros-fs);
    font-weight: var(--box-juros-fw);
    font-style: var(--box-juros-style);
    text-decoration: var(--box-juros-deco);
  }

  .inputBox:has(#presentesValorText) { background: var(--box-gift-bg); border-color: var(--box-gift-border); }
  .inputBox:has(#presentesValorText) .balance { 
    color: var(--box-gift-text); 
    font-size: var(--box-gift-fs);
    font-weight: var(--box-gift-fw);
    font-style: var(--box-gift-style);
    text-decoration: var(--box-gift-deco);
  }

  /* ----------------------------------------------------
     INPUTS INTERNOS E SELECTS
     ---------------------------------------------------- */
  input.textInput, select.textInput{
    outline:none; border:none; background:transparent; width:100%;
    text-align:center;
    /* Defaults se não sobrescritos */
    font-size: var(--global-input-size); 
    font-weight: var(--global-input-weight);
    -webkit-appearance:none; -moz-appearance:none; appearance:none;
    direction: ltr; text-align-last: center; -moz-text-align-last: center;
  }
  select.textInput option{ text-align:center; color:#23395B; }

  /* Textos de Resultado (Balance) */
  .balance{ 
    /* Defaults se não sobrescritos */
    font-size: var(--global-input-size); 
    font-weight: var(--global-input-weight);
    text-align:center; 
  }

  /* Rodapé / Notas */
  .note{ font-size:var(--fs-note); color:var(--text-muted); text-align:center; margin-top:12px; }
  .signature{ font-size:var(--fs-credit); color:var(--text-muted); text-align:center; margin-top:8px; }
  .signature .handle{ color:var(--text-muted); font-weight:800; text-decoration:none; margin-left:6px; }
  .signature a{ color:inherit; text-decoration:none; font-weight:800; }

  /* --- THEME SWITCH --- */
  .theme-container { display:flex; justify-content:center; margin-top:12px; margin-bottom:8px; }
  .switch {
    width: 54px; height: 28px;
    border-radius:999px;
    background: var(--switch-track);
    display:inline-flex; align-items:center; padding:4px; box-sizing:border-box;
    transition: background .18s ease, border-color .12s ease; position: relative; z-index:1;
    border: 2px solid var(--switch-border); overflow: visible;
  }
  .switch.active { background: var(--switch-active-track); }
  .knob {
    width: 20px; height: 20px;
    background: var(--switch-knob);
    border-radius:50%; position: absolute; left:4px;
    display:flex; align-items:center; justify-content:center;
    overflow:hidden; transition: transform .20s ease, background .18s ease;
    z-index:2;
  }
  .switch.active .knob { transform: translateX(26px); }
  
  .knob .icon-sun, .knob .icon-moon {
    width: 12px; height: 12px; position:absolute;
    display:flex; align-items:center; justify-content:center;
    opacity:0; transition: opacity .18s ease, transform .18s ease;
    color: var(--icon-inactive); pointer-events:none;
  }
  .switch:not(.active) .knob .icon-sun { opacity:1; color: var(--icon-active); transform: scale(1); }
  .switch.active .knob .icon-moon { opacity:1; color: var(--icon-active); transform: scale(1); }
  .knob svg path, .knob svg circle, .knob svg rect, .knob svg g { fill: currentColor !important; stroke: none !important; }

  @media (max-width:420px){
    :root{ --field-width:86%; }
    .topImageLink { width: 110px; height: 110px; }
  }

  /* --- MODAL DESIGN --- */
  .modal-overlay{
    position:fixed; inset:0; background:rgba(0,0,0,0.55);
    display:none; align-items:center; justify-content:center; z-index:9999;
  }
  .modal{
    background:var(--bg-card); color:var(--text-main);
    padding:20px 18px; border-radius:12px;
    max-width:320px; width:90%;
    box-shadow:0 12px 30px rgba(0,0,0,0.25); text-align:center;
  }
  .modal h3{ margin:0 0 10px; font-size:16px; font-weight:800; }
  .modal p{ font-size:14px; margin:0 0 8px; color:var(--text-muted); }
  .modal strong{ display: block; font-size: 15px; margin-bottom: 12px; }
  .modal button{
    border:none; border-radius:8px; padding:10px 16px;
    font-size:14px; font-weight:800;
    background:var(--accent-color); color:#fff; cursor:pointer;
  }
  
  :root { --presentes-factor: 0.30; }
</style>
</head>
<body>
  <div class="wrap" id="wrap">
    <div class="card" id="card" role="main">
      <div class="topImageWrap">
        <a class="topImageLink" href="https://www.royalprestige.com/br" target="_blank" rel="noopener noreferrer">
          <img class="topImage" src="" alt="Logo Royal Prestige" id="topLogo">
        </a>
      </div>

      <h1>Calculadora Royal</h1>

      <section aria-labelledby="dados-title">
        <div class="row" id="dados-title">
          <label for="valorNeg">VALOR DE NEGOCIAÇÃO</label>
          <div class="inputBox editableBox">
            <input id="valorNeg" class="textInput" inputmode="decimal" type="text" value="R$ 0,00">
          </div>
        </div>
        <div class="row">
          <label for="desconto">DESCONTO <small>(0% a 10%)</small></label>
          <div class="inputBox editableBox">
            <select id="desconto" class="textInput"></select>
          </div>
        </div>
        <div class="row row-animate" id="rowDescontoOutros">
          <label>DESCONTO <small class="dynamic" id="descMaxLabel">(Máximo R$ 0,00)</small></label>
          <div class="inputBox editableBox">
            <input id="descontoOutros" class="textInput" inputmode="decimal" type="text" value="R$ 0,00">
          </div>
        </div>
        <div class="row">
          <label>VALOR DE VENDA</label>
          <div class="inputBox readonlyBox">
            <div id="valorVendaText" class="balance">R$ 0,00</div>
          </div>
        </div>
      </section>

      <section>
        <div class="section-title">FINANCIAMENTO / BOLETO</div>
        <div class="row" style="margin-top:10px">
          <label for="entrada">ENTRADA <small>(5% a 50%)</small></label>
          <div class="inputBox editableBox">
            <select id="entrada" class="textInput"></select>
          </div>
        </div>
        <div class="row row-animate" id="rowEntradaOutros">
          <label>VALOR DE ENTRADA <small class="dynamic" id="minEntradaLabel">(Minimo R$ 0,00)</small></label>
          <div class="inputBox editableBox">
            <input id="entradaOutros" class="textInput" inputmode="decimal" type="text" value="R$ 0,00">
          </div>
        </div>
        <div class="row">
          <label for="numParcelas">NÚMERO DE PARCELAS <small>(Até 30x no boleto)</small></label>
          <div class="inputBox editableBox">
            <select id="numParcelas" class="textInput"></select>
          </div>
        </div>
        <div class="row">
          <label>VALOR DA ENTRADA <small class="dynamic" id="labelValorEntradaSmall">(R$ 0,00 em 12x)</small></label>
          <div class="inputBox highlight">
            <div id="valorEntradaText" class="balance">R$ 0,00</div>
          </div>
        </div>
        <div class="row">
          <label>VALOR DA PARCELA MENSAL <small class="dynamic" id="labelValorParcelaSmall">(Em 00x no boleto)</small></label>
          <div class="inputBox highlight">
            <div id="valorParcelaText" class="balance">R$ 0,00</div>
          </div>
        </div>
      </section>

      <section>
        <div class="section-title">CARTÃO DE CRÉDITO</div>
        <div class="row" style="margin-top:10px">
          <label for="cartao">CARTÃO <small>(Sem juros)</small></label>
          <div class="inputBox editableBox">
            <select id="cartao" class="textInput"></select>
          </div>
        </div>
        <div class="row">
          <label>PARCELA NO CARTÃO</label>
          <div class="inputBox highlight">
            <div id="cartaoParcelaText" class="balance">R$ 0,00</div>
          </div>
        </div>
      </section>

      <section>
        <div class="section-title">TOTAIS E INFORMAÇÕES FINAIS</div>
        <div class="row" style="margin-top:10px">
          <label>SALDO A PAGAR SEM JUROS</label>
          <div class="inputBox readonlyBox"><div id="saldoSemJurosText" class="balance">R$ 0,00</div></div>
        </div>
        <div class="row">
          <label>VALOR PARCELADO</label>
          <div class="inputBox readonlyBox"><div id="valorParceladoText" class="balance">R$ 0,00</div></div>
        </div>
        <div class="row">
          <label>PRIMEIRA PARCELA <small>(Para 40 dias)</small></label>
          <div class="inputBox readonlyBox"><div id="primeiraParcelaText" class="balance">--/--/----</div></div>
        </div>
        <div class="row">
          <label>VALOR TOTAL DA VENDA <small>(Incluindo juros e taxas)</small></label>
          <div class="inputBox readonlyBox"><div id="valorTotalVendaText" class="balance">R$ 0,00</div></div>
        </div>
        <div class="row">
          <label>MONTANTE TOTAL DE JUROS</label>
          <div class="inputBox readonlyBox"><div id="totalJurosText" class="balance">R$ 0,00</div></div>
        </div>
      </section>

      <section>
        <div class="section-title">PRESENTES</div>
        <div class="row" style="margin-top:10px">
          <label for="valorPresentes">VALOR PARA PRESENTES <small class="dynamic" id="presentesFactorSmall">(30%)</small></label>
          <div class="inputBox readonlyBox">
            <div id="presentesValorText" class="balance">R$ 0,00</div>
          </div>
        </div>
      </section>

      <section>
        <div class="section-title">DOCUMENTAÇÃO</div>
        <div class="row" style="margin-top:8px; gap:2px;">
          <label class="doc-label">• Documento com foto</label>
          <label class="doc-label">• Comprovante de renda</label>
          <label class="doc-label">• Comprovante de endereço</label>
        </div>
      </section>

      <div class="theme-container">
        <button id="themeSwitch" class="switch" type="button">
          <div class="knob">
            <span class="icon-sun"></span>
            <span class="icon-moon"></span>
          </div>
        </button>
      </div>

      <div class="note">Campos em <strong>rosa</strong> são editáveis. Campos em <strong>amarelo</strong> são os principais em destaque.</div>

      <div class="signature">
        <span class="developer">developed by</span>
        <a class="handle" href="https://wa.me/5512988855235" target="_blank" rel="noopener noreferrer">@erikprosa</a>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="modalDesconto">
    <div class="modal">
      <h3>Desconto acima do permitido</h3>
      <p>O valor digitado é maior que o desconto máximo permitido.</p>
      <strong id="modalMaxDescValue">R$ 0,00</strong>
      <button type="button" onclick="closeModalDesconto()">Entendi</button>
    </div>
  </div>

  <div class="modal-overlay" id="modalEntradaMin">
    <div class="modal">
      <h3>Valor definido inferior ao minimo</h3>
      <p>O valor da entrada não pode ser menor que 5% do valor de venda.</p>
      <strong id="modalMinEntradaValue">R$ 0,00</strong>
      <button type="button" onclick="closeModalEntradaMin()">Entendi</button>
    </div>
  </div>

  <div class="modal-overlay" id="modalEntradaMax">
    <div class="modal">
      <h3>Valor definido superior ao valor negociado</h3>
      <p>O valor da entrada não pode ser maior que o valor total de venda.</p>
      <strong id="modalMaxEntradaValue">R$ 0,00</strong>
      <button type="button" onclick="closeModalEntradaMax()">Entendi</button>
    </div>
  </div>

<script>
/* -----------------------
   LÓGICA E UTILITÁRIOS
   ----------------------- */
const brl = new Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL'});
function clamp(n, min, max){ if (isNaN(n)) return min; return Math.min(max, Math.max(min, n)); }
function parsePercentFromSelect(v){ const n = parseInt(String(v).replace('%',''),10); if (isNaN(n)) return 0; return n/100; }
function formatToBRLNumber(value){ return brl.format(value); }
function parseBRLStringToNumber(str){
  if (!str) return 0;
  let s = String(str).replace(/[R$\s]/g,'').replace(/\./g,'').replace(/,/g,'.');
  const n = parseFloat(s);
  return isNaN(n) ? 0 : n;
}
function round2(n){ return Math.round((n + Number.EPSILON) * 100) / 100; }
function roundCommercial2(n){
  if (!isFinite(n)) return 0;
  const scaled = Math.floor(n * 1000 + 1e-9);
  const third = scaled % 10;
  if (third <= 5) return Math.floor(n * 100 + 1e-9) / 100;
  else return Math.ceil(n * 100 - 1e-9) / 100;
}
function formatCurrencyInputEl(el, rawValue){ el.value = formatToBRLNumber(round2(rawValue)); }
function formatDateBR(d){ return String(d.getDate()).padStart(2,'0') + '/' + String(d.getMonth()+1).padStart(2,'0') + '/' + d.getFullYear(); }
function addDaysAdjust(d0, days){
  const d = new Date(d0.getTime());
  d.setDate(d.getDate() + days);
  if (d.getDate() >= 29) return new Date(d.getFullYear(), d.getMonth()+1, 1);
  return d;
}

const elValorNeg = document.getElementById('valorNeg');
const elDesconto = document.getElementById('desconto');
const elEntrada = document.getElementById('entrada');
const elNumParcelas = document.getElementById('numParcelas');
const elCartao = document.getElementById('cartao');
const elDescOutros = document.getElementById('descontoOutros');
const elEntradaOutros = document.getElementById('entradaOutros');

const outValorVenda = document.getElementById('valorVendaText');
const outValorEntrada = document.getElementById('valorEntradaText');
const labelValorEntradaSmall = document.getElementById('labelValorEntradaSmall');
const outValorParcela = document.getElementById('valorParcelaText');
const labelValorParcelaSmall = document.getElementById('labelValorParcelaSmall');
const outCartaoParcela = document.getElementById('cartaoParcelaText');
const outSaldoSemJuros = document.getElementById('saldoSemJurosText');
const outValorParcelado = document.getElementById('valorParceladoText');
const outPrimeiraParcela = document.getElementById('primeiraParcelaText');
const outValorTotalVenda = document.getElementById('valorTotalVendaText');
const outTotalJuros = document.getElementById('totalJurosText');
const outPresentes = document.getElementById('presentesValorText');
const outPresentesFactorLabel = document.getElementById('presentesFactorSmall');

(function populateSelects(){
  for (let i=0;i<=10;i++){
    const opt = document.createElement('option'); opt.value = i+'%'; opt.textContent = i+'%';
    elDesconto.appendChild(opt);
  }
  let optOut = document.createElement("option"); optOut.value="outros"; optOut.textContent="Outros"; elDesconto.appendChild(optOut);
  for (let i=5;i<=50;i+=5){
    const opt = document.createElement('option'); opt.value = i+'%'; opt.textContent = i+'%';
    elEntrada.appendChild(opt);
  }
  let optOutEntrada = document.createElement("option"); optOutEntrada.value="outros"; optOutEntrada.textContent="Outros"; elEntrada.appendChild(optOutEntrada);
  for (let i=1;i<=30;i++){
    const opt = document.createElement('option'); opt.value = i; opt.textContent = i+'x';
    elNumParcelas.appendChild(opt);
  }
  for (let i=1;i<=18;i++){
    const opt = document.createElement('option'); opt.value = i; opt.textContent = i+'x';
    elCartao.appendChild(opt);
  }
  elDesconto.value = '0%'; elEntrada.value = '10%'; elNumParcelas.value = '30'; elCartao.value = '12';
})();

function calcularTudo(){
  const valorNeg = round2(parseBRLStringToNumber(elValorNeg.value));
  let desconto = parsePercentFromSelect(elDesconto.value);
  if(elDesconto.value==="outros"){
    desconto = valorNeg > 0 ? parseBRLStringToNumber(elDescOutros.value) / valorNeg : 0;
  }

  const valorVenda = round2(valorNeg * (1 - desconto));
  const maxDesc = round2(valorNeg * 0.10);
  document.getElementById("descMaxLabel").textContent = "(Máximo " + formatToBRLNumber(maxDesc) + ")";

  const minEntradaVal = round2(valorVenda * 0.05);
  document.getElementById("minEntradaLabel").textContent = "(Minimo " + formatToBRLNumber(minEntradaVal) + ")";

  let valorEntrada;
  if(elEntrada.value === "outros"){
    valorEntrada = parseBRLStringToNumber(elEntradaOutros.value);
  } else {
    valorEntrada = round2(valorVenda * parsePercentFromSelect(elEntrada.value));
  }

  const saldoSemJuros = round2(valorVenda - valorEntrada);
  const parcelas = clamp(parseInt(elNumParcelas.value,10) || 1, 1, 30);
  let totalParcelado = parcelas === 1 ? saldoSemJuros : round2(saldoSemJuros * (1 + (parcelas/100)));
  let paymentMonthly = parcelas === 1 ? totalParcelado : roundCommercial2(totalParcelado / parcelas);

  const valorTotalVenda = round2(valorEntrada + totalParcelado);
  const totalJuros = round2(valorTotalVenda - valorVenda);
  const cartaoParcelas = parseInt(elCartao.value,10) || 1;
  const cartaoParcela = round2(valorVenda / cartaoParcelas);

  outValorVenda.textContent = formatToBRLNumber(valorVenda);
  outValorEntrada.textContent = formatToBRLNumber(valorEntrada);
  labelValorEntradaSmall.textContent = '(' + formatToBRLNumber(round2(valorEntrada/12)) + ' em 12x)';
  outValorParcela.textContent = formatToBRLNumber(paymentMonthly);
  labelValorParcelaSmall.textContent = '(Em ' + parcelas + 'x no boleto)';
  outCartaoParcela.textContent = formatToBRLNumber(cartaoParcela);
  outSaldoSemJuros.textContent = formatToBRLNumber(saldoSemJuros);
  outValorParcelado.textContent = formatToBRLNumber(totalParcelado);
  outPrimeiraParcela.textContent = formatDateBR(addDaysAdjust(new Date(), 40));
  outValorTotalVenda.textContent = formatToBRLNumber(valorTotalVenda);
  outTotalJuros.textContent = formatToBRLNumber(totalJuros);
  
  const rawFactor = getComputedStyle(document.documentElement).getPropertyValue('--presentes-factor') || '0.30';
  let pf = parseFloat(rawFactor); if (pf > 1) pf /= 100;
  outPresentes.textContent = formatToBRLNumber(round2(valorVenda * pf));
  outPresentesFactorLabel.textContent = '(' + Math.round(pf*100) + '%)';
}

/* HANDLERS */
function handleValorNegInput(e){
  let onlyNums = e.target.value.replace(/[^\d]/g,'');
  if (onlyNums === '') { e.target.value = 'R$ 0,00'; calcularTudo(); return; }
  e.target.value = brl.format(parseFloat(onlyNums) / 100);
  calcularTudo();
}

function handleDescontoOutrosInput(e){
  let onlyNums = e.target.value.replace(/[^\d]/g,'');
  if (onlyNums === '') { e.target.value = 'R$ 0,00'; calcularTudo(); return; }
  let asNumber = parseFloat(onlyNums) / 100;
  const valorNeg = parseBRLStringToNumber(elValorNeg.value);
  const maxDesc = round2(valorNeg * 0.10);
  if (asNumber > maxDesc) { showModalDesconto(); asNumber = 0; }
  e.target.value = brl.format(asNumber);
  calcularTudo();
}

function handleEntradaOutrosInput(e){
  let onlyNums = e.target.value.replace(/[^\d]/g,'');
  if (onlyNums === '') { e.target.value = 'R$ 0,00'; calcularTudo(); return; }
  let asNumber = parseFloat(onlyNums) / 100;
  const valorVenda = parseBRLStringToNumber(outValorVenda.textContent);
  if (asNumber > valorVenda) { showModalEntradaMax(valorVenda); asNumber = 0; }
  e.target.value = brl.format(asNumber);
  calcularTudo();
}

elEntradaOutros.addEventListener('blur', () => {
  let asNumber = parseBRLStringToNumber(elEntradaOutros.value);
  const valorVenda = parseBRLStringToNumber(outValorVenda.textContent);
  const minE = round2(valorVenda * 0.05);
  if (asNumber < minE && asNumber > 0) { showModalEntradaMin(minE); asNumber = 0; }
  formatCurrencyInputEl(elEntradaOutros, asNumber);
  calcularTudo();
});

elValorNeg.addEventListener('input', handleValorNegInput);
elValorNeg.addEventListener('blur', () => formatCurrencyInputEl(elValorNeg, parseBRLStringToNumber(elValorNeg.value)));
elDescOutros.addEventListener('input', handleDescontoOutrosInput);
elDescOutros.addEventListener('blur', () => formatCurrencyInputEl(elDescOutros, parseBRLStringToNumber(elDescOutros.value)));
elEntradaOutros.addEventListener('input', handleEntradaOutrosInput);
elDesconto.addEventListener('change', e => { document.getElementById("rowDescontoOutros").classList.toggle("show", e.target.value === "outros"); calcularTudo(); });
elEntrada.addEventListener('change', e => { document.getElementById("rowEntradaOutros").classList.toggle("show", e.target.value === "outros"); calcularTudo(); });
elNumParcelas.addEventListener('change', calcularTudo);
elCartao.addEventListener('change', calcularTudo);

/* MODAL LOGIC */
function showModalDesconto(){ 
  const valorNeg = parseBRLStringToNumber(elValorNeg.value);
  document.getElementById('modalMaxDescValue').textContent = formatToBRLNumber(round2(valorNeg * 0.10));
  document.getElementById('modalDesconto').style.display = 'flex'; 
}
function closeModalDesconto(){ document.getElementById('modalDesconto').style.display = 'none'; elDescOutros.value = 'R$ 0,00'; calcularTudo(); }
function showModalEntradaMin(val){ document.getElementById('modalMinEntradaValue').textContent = formatToBRLNumber(val); document.getElementById('modalEntradaMin').style.display = 'flex'; }
function closeModalEntradaMin(){ document.getElementById('modalEntradaMin').style.display = 'none'; elEntradaOutros.value = 'R$ 0,00'; calcularTudo(); }
function showModalEntradaMax(val){ document.getElementById('modalMaxEntradaValue').textContent = formatToBRLNumber(val); document.getElementById('modalEntradaMax').style.display = 'flex'; }
function closeModalEntradaMax(){ document.getElementById('modalEntradaMax').style.display = 'none'; elEntradaOutros.value = 'R$ 0,00'; calcularTudo(); }

/* TEMAS E ICONES */
(function themeInit(){
  const stored = localStorage.getItem('royal_theme');
  let current = stored || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
  const switchBtn = document.getElementById('themeSwitch');
  const topLogoImg = document.getElementById('topLogo');

  async function applyTheme(theme){
    document.body.classList.toggle('theme-dark', theme === 'dark');
    switchBtn.classList.toggle('active', theme === 'dark');
    
    // CORREÇÃO CIRÚRGICA: Busca a variável específica conforme a classe presente no body
    const style = getComputedStyle(document.documentElement);
    let targetUrl = "";
    
    if (document.body.classList.contains('theme-dark')) {
      targetUrl = style.getPropertyValue('--src-logo-dark');
    } else {
      targetUrl = style.getPropertyValue('--src-logo-light');
    }
    
    // Limpeza da string da URL para o src da img
    targetUrl = targetUrl.replace(/url\("(.*)"\)/, '$1').trim();
    if(targetUrl) topLogoImg.src = targetUrl;
    
    localStorage.setItem('royal_theme', theme);
  }
  
  applyTheme(current);
  switchBtn.onclick = () => { current = current === 'dark' ? 'light' : 'dark'; applyTheme(current); };
})();

async function injectIcon(spanEl) {
  const style = getComputedStyle(document.documentElement);
  let urlVar = "";
  if(spanEl.classList.contains("icon-sun")) urlVar = style.getPropertyValue('--src-icon-sun');
  if(spanEl.classList.contains("icon-moon")) urlVar = style.getPropertyValue('--src-icon-moon');
  
  const url = urlVar.replace(/"/g, '').trim();

  try {
    const resp = await fetch(url);
    const txt = await resp.text();
    spanEl.innerHTML = txt;
    const svg = spanEl.querySelector('svg');
    svg.querySelectorAll('[fill],[stroke]').forEach(el=>{ el.removeAttribute('fill'); el.removeAttribute('stroke'); });
  } catch (e) { spanEl.innerHTML = '●'; }
}
document.querySelectorAll('.knob span').forEach(injectIcon);

calcularTudo();
</script>
</body>
</html>
